# 비활성 사용자 이벤트 효과 분석 가이드

이 가이드는 DB2 프로젝트에서 제공하는 비활성 사용자 이벤트 효과 분석 도구의 사용 방법을 설명합니다.

## 개요

게임 서비스에서는 일정 기간 접속하지 않은 사용자들을 다시 게임으로 유도하기 위해 다양한 이벤트를 제공합니다. 이 분석 도구는 이러한 이벤트가 비활성 사용자의 재참여와 입금 전환에 미치는 영향을 분석하여 효과적인 마케팅 전략을 수립하는 데 도움을 줍니다.

## 주요 개념

### 비활성 사용자

일정 기간(기본값: 10일) 이상 게임에 접속하지 않은 사용자를 의미합니다. `lastPlayDate` 필드를 기준으로 판단합니다.

### 이벤트 참여

사용자가 이벤트를 통해 보상을 받은 경우를 의미합니다. `promotion_players` 테이블의 기록을 기준으로 판단합니다.

### 전환

이벤트 참여 이후 입금을 한 사용자를 전환된 사용자로 간주합니다. `money_flows` 테이블의 `type=0`(입금) 기록 중 첫 이벤트 참여 이후의 기록을 기준으로 판단합니다.

### ROI (Return on Investment)

이벤트를 통해 지급된 금액 대비 이후 발생한 입금액의 비율을 의미합니다. 
계산식: ((입금액 / 지급액) - 1) * 100%

## 분석 실행하기

### 명령행 도구 사용

```bash
python scripts/analyze_inactive_events.py --days 10 --output ./reports/user
```

#### 매개변수 설명

- `--days`: 비활성으로 간주할 최소 일수 (기본값: 10)
- `--output`: 결과 저장 디렉토리 (기본값: ./reports/user)
- `--json`: 결과를 JSON 형식으로도 출력

### 코드에서 직접 사용

```python
from src.analysis.user.inactive_event_analyzer import InactiveUserEventAnalyzer

# 분석기 초기화
analyzer = InactiveUserEventAnalyzer()

# 비활성 사용자 중 이벤트 후 입금한 사용자 목록 조회
results = analyzer.get_inactive_event_deposit_users(days_inactive=10)

# 비활성 기간별 전환율 분석
inactive_analysis = analyzer.analyze_conversion_by_inactive_period()

# 이벤트 금액별 전환율 분석
amount_analysis = analyzer.analyze_conversion_by_event_amount()

# 분석 보고서 생성
report = analyzer.generate_analysis_report()
```

## 대시보드 사용하기

### 대시보드 실행

```bash
python scripts/run_dashboard.py --port 8050 --debug
```

#### 매개변수 설명

- `--port`: 서버 포트 (기본값: 8050)
- `--debug`: 디버그 모드 활성화 (개발 중 오류 확인에 유용)

### 대시보드 인터페이스

브라우저에서 `http://localhost:8050`에 접속하면 다음과 같은 대시보드 인터페이스를 볼 수 있습니다:

#### 요약 정보

대시보드 상단에는 다음 주요 지표들이 카드 형태로 표시됩니다:
- 비활성 사용자 수
- 이벤트 참여자 수
- 입금 전환자 수
- 전환율
- 이벤트 총액
- 입금 총액
- ROI

#### 분석 조건 설정

분석 조건 섹션에서는 다음과 같은 설정을 조정할 수 있습니다:
- 비활성 기간 (일): 슬라이더를 통해 비활성으로 간주할 최소 일수를 설정
- 분석 실행 버튼: 설정된 조건으로 분석을 다시 실행

#### 비활성 기간별 전환율 그래프

비활성 기간별 전환율 그래프는 다음 정보를 보여줍니다:
- X축: 비활성 기간 구간 (일)
- Y축 (왼쪽): 전환율 (%)
- Y축 (오른쪽): ROI (%)

이 그래프를 통해 비활성 기간에 따른 전환율과 ROI의 변화를 파악할 수 있습니다.

#### 이벤트 금액별 전환율 그래프

이벤트 금액별 전환율 그래프는 다음 정보를 보여줍니다:
- X축: 이벤트 금액 구간
- Y축 (왼쪽): 전환율 (%)
- Y축 (오른쪽): ROI (%)

이 그래프를 통해 이벤트 지급 금액에 따른 전환율과 ROI의 변화를 파악할 수 있습니다.

#### 전환 사용자 목록

전환 사용자 목록 테이블은 다음 정보를 포함합니다:
- 사용자 ID
- 사용자 이름
- 이벤트 횟수
- 이벤트 지급액
- 입금액
- 입금 횟수
- 첫 이벤트 날짜
- 마지막 게임 날짜
- 비활성 일수

이 테이블은 검색, 정렬, 필터링 기능을 제공하여 특정 조건의 사용자를 쉽게 찾을 수 있습니다.

## 분석 결과 해석하기

### 비활성 기간별 전환율 분석

비활성 기간별 전환율 분석은 사용자의 비활성 기간에 따른 이벤트 효과를 보여줍니다. 이를 통해 다음과 같은 인사이트를 얻을 수 있습니다:

- 어떤 비활성 기간 구간의 사용자가 이벤트에 가장 잘 반응하는지
- 비활성 기간이 길어질수록 전환율과 ROI가 어떻게 변화하는지
- 비활성 기간에 따른 최적의 이벤트 타이밍

### 이벤트 금액별 전환율 분석

이벤트 금액별 전환율 분석은 이벤트 지급 금액에 따른 효과를 보여줍니다. 이를 통해 다음과 같은 인사이트를 얻을 수 있습니다:

- 어떤 금액 구간의 이벤트가 가장 높은 전환율을 보이는지
- 이벤트 금액이 증가함에 따라 ROI가 어떻게 변화하는지
- 비용 효율적인 이벤트 보상 금액 설정

### 종합 분석

비활성 기간과 이벤트 금액 두 가지 측면을 종합적으로 분석하면 다음과 같은 질문에 답할 수 있습니다:

1. 어떤 비활성 사용자 그룹에게 어떤 금액의 이벤트를 제공하는 것이 가장 효과적인가?
2. 비활성 기간별로 최적의 이벤트 금액 구간이 다른가?
3. 비용 대비 가장 높은 ROI를 얻을 수 있는 전략은 무엇인가?

## 활용 사례

### 타겟 마케팅 최적화

분석 결과를 바탕으로 비활성 사용자를 세그먼트화하고, 각 세그먼트에 맞는 이벤트 전략을 수립할 수 있습니다.

예: 30-60일 비활성 사용자에게는 X 금액의 이벤트를, 60-90일 비활성 사용자에게는 Y 금액의 이벤트를 제공

### 이벤트 ROI 최대화

이벤트 금액별 ROI 분석을 통해 가장 비용 효율적인 이벤트 보상 금액을 결정할 수 있습니다.

### 비활성 사용자 재활성화 캠페인

비활성 기간별 전환율 분석을 통해 언제 재활성화 캠페인을 시작하는 것이 가장 효과적인지 결정할 수 있습니다.

## 문제 해결

### 데이터베이스 연결 문제

데이터베이스 연결에 문제가 있는 경우:
1. `.env` 파일의 연결 정보가 올바른지 확인
2. 데이터베이스 서버가 실행 중인지 확인
3. 네트워크 연결 상태 확인

### 대시보드 표시 문제

대시보드가 제대로 표시되지 않는 경우:
1. 콘솔 로그에서 오류 메시지 확인
2. 필요한 라이브러리가 모두 설치되어 있는지 확인
3. 대시보드 서버가 올바른 포트에서 실행 중인지 확인

## 추가 기능 개발

이 분석 도구는 확장 가능하도록 설계되었습니다. 다음과 같은 추가 기능을 개발할 수 있습니다:

1. 예측 모델 추가: 어떤 비활성 사용자가 이벤트에 반응할 가능성이 높은지 예측
2. 추가 이벤트 유형 분석: 다양한 이벤트 유형별 효과 비교
3. 자동화된 보고서 생성: 정기적인 분석 보고서 자동 생성
4. A/B 테스트 프레임워크: 다양한 이벤트 전략의 효과를 실시간으로 비교

## 참고 자료

- [MariaDB 공식 문서](https://mariadb.com/kb/en/documentation/)
- [Dash 대시보드 문서](https://dash.plotly.com/)
- [Pandas 데이터 분석 라이브러리](https://pandas.pydata.org/docs/)
- [Plotly 시각화 라이브러리](https://plotly.com/python/)
